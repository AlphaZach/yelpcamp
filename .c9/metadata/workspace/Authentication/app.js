{"filter":false,"title":"app.js","tooltip":"/Authentication/app.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":3,"column":19},"end":{"row":3,"column":20},"action":"insert","lines":[" "],"id":164}],[{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"insert","lines":["="],"id":165}],[{"start":{"row":3,"column":21},"end":{"row":3,"column":22},"action":"insert","lines":[" "],"id":166}],[{"start":{"row":3,"column":22},"end":{"row":3,"column":23},"action":"insert","lines":["r"],"id":167}],[{"start":{"row":3,"column":23},"end":{"row":3,"column":24},"action":"insert","lines":["e"],"id":168}],[{"start":{"row":3,"column":24},"end":{"row":3,"column":25},"action":"insert","lines":["q"],"id":169}],[{"start":{"row":3,"column":25},"end":{"row":3,"column":26},"action":"insert","lines":["u"],"id":170}],[{"start":{"row":3,"column":26},"end":{"row":3,"column":27},"action":"insert","lines":["i"],"id":171}],[{"start":{"row":3,"column":27},"end":{"row":3,"column":28},"action":"insert","lines":["r"],"id":172}],[{"start":{"row":3,"column":28},"end":{"row":3,"column":29},"action":"insert","lines":["e"],"id":173}],[{"start":{"row":3,"column":29},"end":{"row":3,"column":31},"action":"insert","lines":["()"],"id":174}],[{"start":{"row":3,"column":30},"end":{"row":3,"column":32},"action":"insert","lines":["\"\""],"id":175}],[{"start":{"row":3,"column":31},"end":{"row":3,"column":32},"action":"insert","lines":["b"],"id":176}],[{"start":{"row":3,"column":32},"end":{"row":3,"column":33},"action":"insert","lines":["o"],"id":177}],[{"start":{"row":3,"column":33},"end":{"row":3,"column":34},"action":"insert","lines":["d"],"id":178}],[{"start":{"row":3,"column":34},"end":{"row":3,"column":35},"action":"insert","lines":["y"],"id":179}],[{"start":{"row":3,"column":35},"end":{"row":3,"column":36},"action":"insert","lines":["-"],"id":180}],[{"start":{"row":3,"column":36},"end":{"row":3,"column":37},"action":"insert","lines":["p"],"id":181}],[{"start":{"row":3,"column":37},"end":{"row":3,"column":38},"action":"insert","lines":["a"],"id":182}],[{"start":{"row":3,"column":38},"end":{"row":3,"column":39},"action":"insert","lines":["r"],"id":183}],[{"start":{"row":3,"column":39},"end":{"row":3,"column":40},"action":"insert","lines":["s"],"id":184}],[{"start":{"row":3,"column":40},"end":{"row":3,"column":41},"action":"insert","lines":["e"],"id":185}],[{"start":{"row":3,"column":41},"end":{"row":3,"column":42},"action":"insert","lines":["r"],"id":186}],[{"start":{"row":3,"column":44},"end":{"row":3,"column":45},"action":"insert","lines":[","],"id":187}],[{"start":{"row":3,"column":45},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":188}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"insert","lines":["v"],"id":189}],[{"start":{"row":4,"column":1},"end":{"row":4,"column":2},"action":"insert","lines":["a"],"id":190}],[{"start":{"row":4,"column":2},"end":{"row":4,"column":3},"action":"insert","lines":["r"],"id":191}],[{"start":{"row":4,"column":3},"end":{"row":4,"column":4},"action":"insert","lines":[" "],"id":192}],[{"start":{"row":4,"column":3},"end":{"row":4,"column":4},"action":"remove","lines":[" "],"id":193}],[{"start":{"row":4,"column":2},"end":{"row":4,"column":3},"action":"remove","lines":["r"],"id":194}],[{"start":{"row":4,"column":1},"end":{"row":4,"column":2},"action":"remove","lines":["a"],"id":195}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"remove","lines":["v"],"id":196}],[{"start":{"row":3,"column":0},"end":{"row":3,"column":3},"action":"remove","lines":["var"],"id":197}],[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["r"],"id":198}],[{"start":{"row":2,"column":1},"end":{"row":2,"column":2},"action":"remove","lines":["a"],"id":199}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":1},"action":"remove","lines":["v"],"id":200}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"remove","lines":["r"],"id":201}],[{"start":{"row":1,"column":1},"end":{"row":1,"column":2},"action":"remove","lines":["a"],"id":202}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"remove","lines":["v"],"id":203}],[{"start":{"row":0,"column":0},"end":{"row":4,"column":0},"action":"remove","lines":["var express         = require(\"express\"),"," mongoose        = require(\"mongoose\"),"," passport        = require(\"passport\"),"," bodyParser      = require(\"body-parser\"),",""],"id":204},{"start":{"row":0,"column":0},"end":{"row":6,"column":62},"action":"insert","lines":["var express               = require(\"express\"),","    mongoose              = require(\"mongoose\"),","    passport              = require(\"passport\"),","    bodyParser            = require(\"body-parser\"),","    User                  = require(\"./models/user\"),","    LocalStrategy         = require(\"passport-local\"),","    passportLocalMongoose = require(\"passport-local-mongoose\")"]}],[{"start":{"row":6,"column":62},"end":{"row":7,"column":0},"action":"insert","lines":["",""],"id":205},{"start":{"row":7,"column":0},"end":{"row":7,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":7,"column":4},"end":{"row":8,"column":0},"action":"insert","lines":["",""],"id":206},{"start":{"row":8,"column":0},"end":{"row":8,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":4},"action":"remove","lines":["    "],"id":207}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":54},"action":"insert","lines":["mongoose.connect(\"mongodb://localhost/auth_demo_app\");"],"id":208}],[{"start":{"row":8,"column":54},"end":{"row":9,"column":0},"action":"insert","lines":["",""],"id":209}],[{"start":{"row":9,"column":0},"end":{"row":16,"column":4},"action":"insert","lines":["var app = express();","app.set('view engine', 'ejs');","app.use(bodyParser.urlencoded({extended: true}));","app.use(require(\"express-session\")({","    secret: \"Rusty is the best and cutest dog in the world\",","    resave: false,","    saveUninitialized: false","}));"],"id":210}],[{"start":{"row":16,"column":4},"end":{"row":17,"column":0},"action":"insert","lines":["",""],"id":211}],[{"start":{"row":17,"column":0},"end":{"row":18,"column":0},"action":"insert","lines":["",""],"id":212}],[{"start":{"row":18,"column":0},"end":{"row":18,"column":1},"action":"insert","lines":["v"],"id":213}],[{"start":{"row":18,"column":0},"end":{"row":18,"column":1},"action":"remove","lines":["v"],"id":214}],[{"start":{"row":18,"column":0},"end":{"row":23,"column":49},"action":"insert","lines":["app.use(passport.initialize());","app.use(passport.session());","","passport.use(new LocalStrategy(User.authenticate()));","passport.serializeUser(User.serializeUser());","passport.deserializeUser(User.deserializeUser());"],"id":215}],[{"start":{"row":23,"column":49},"end":{"row":24,"column":0},"action":"insert","lines":["",""],"id":216}],[{"start":{"row":24,"column":0},"end":{"row":25,"column":0},"action":"insert","lines":["",""],"id":217}],[{"start":{"row":25,"column":0},"end":{"row":27,"column":14},"action":"insert","lines":["//============","// ROUTES","//============"],"id":218}],[{"start":{"row":27,"column":14},"end":{"row":28,"column":0},"action":"insert","lines":["",""],"id":219}],[{"start":{"row":28,"column":0},"end":{"row":29,"column":0},"action":"insert","lines":["",""],"id":220}],[{"start":{"row":29,"column":0},"end":{"row":35,"column":3},"action":"insert","lines":["app.get(\"/\", function(req, res){","    res.render(\"home\");","});","","app.get(\"/secret\",isLoggedIn, function(req, res){","   res.render(\"secret\"); ","});"],"id":221}],[{"start":{"row":35,"column":3},"end":{"row":36,"column":0},"action":"insert","lines":["",""],"id":222}],[{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"insert","lines":["",""],"id":223}],[{"start":{"row":37,"column":0},"end":{"row":42,"column":3},"action":"insert","lines":["// Auth Routes","","//show sign up form","app.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});"],"id":224}],[{"start":{"row":42,"column":3},"end":{"row":43,"column":0},"action":"insert","lines":["",""],"id":225}],[{"start":{"row":43,"column":0},"end":{"row":44,"column":0},"action":"insert","lines":["",""],"id":226}],[{"start":{"row":44,"column":0},"end":{"row":44,"column":1},"action":"insert","lines":["/"],"id":227}],[{"start":{"row":44,"column":1},"end":{"row":44,"column":2},"action":"insert","lines":["/"],"id":228}],[{"start":{"row":44,"column":2},"end":{"row":44,"column":3},"action":"insert","lines":["h"],"id":229}],[{"start":{"row":44,"column":3},"end":{"row":44,"column":4},"action":"insert","lines":["a"],"id":230}],[{"start":{"row":44,"column":4},"end":{"row":44,"column":5},"action":"insert","lines":["d"],"id":231}],[{"start":{"row":44,"column":4},"end":{"row":44,"column":5},"action":"remove","lines":["d"],"id":232}],[{"start":{"row":44,"column":4},"end":{"row":44,"column":5},"action":"insert","lines":["n"],"id":233}],[{"start":{"row":44,"column":5},"end":{"row":44,"column":6},"action":"insert","lines":["d"],"id":234}],[{"start":{"row":44,"column":6},"end":{"row":44,"column":7},"action":"insert","lines":["i"],"id":235}],[{"start":{"row":44,"column":7},"end":{"row":44,"column":8},"action":"insert","lines":["n"],"id":236}],[{"start":{"row":44,"column":8},"end":{"row":44,"column":9},"action":"insert","lines":["g"],"id":237}],[{"start":{"row":44,"column":9},"end":{"row":44,"column":10},"action":"insert","lines":[" "],"id":238}],[{"start":{"row":44,"column":10},"end":{"row":44,"column":11},"action":"insert","lines":["u"],"id":239}],[{"start":{"row":44,"column":11},"end":{"row":44,"column":12},"action":"insert","lines":["s"],"id":240}],[{"start":{"row":44,"column":12},"end":{"row":44,"column":13},"action":"insert","lines":["e"],"id":241}],[{"start":{"row":44,"column":13},"end":{"row":44,"column":14},"action":"insert","lines":["r"],"id":242}],[{"start":{"row":44,"column":14},"end":{"row":44,"column":15},"action":"insert","lines":[" "],"id":243}],[{"start":{"row":44,"column":15},"end":{"row":44,"column":16},"action":"insert","lines":["s"],"id":244}],[{"start":{"row":44,"column":16},"end":{"row":44,"column":17},"action":"insert","lines":["i"],"id":245}],[{"start":{"row":44,"column":17},"end":{"row":44,"column":18},"action":"insert","lines":["g"],"id":246}],[{"start":{"row":44,"column":18},"end":{"row":44,"column":19},"action":"insert","lines":["n"],"id":247}],[{"start":{"row":44,"column":19},"end":{"row":44,"column":20},"action":"insert","lines":[" "],"id":248}],[{"start":{"row":44,"column":20},"end":{"row":44,"column":21},"action":"insert","lines":["u"],"id":249}],[{"start":{"row":44,"column":21},"end":{"row":44,"column":22},"action":"insert","lines":["p"],"id":250}],[{"start":{"row":44,"column":22},"end":{"row":45,"column":0},"action":"insert","lines":["",""],"id":251}],[{"start":{"row":45,"column":0},"end":{"row":55,"column":3},"action":"insert","lines":["app.post(\"/register\", function(req, res){","    User.register(new User({username: req.body.username}), req.body.password, function(err, user){","        if(err){","            console.log(err);","            return res.render('register');","        }","        passport.authenticate(\"local\")(req, res, function(){","           res.redirect(\"/secret\");","        });","    });","});"],"id":252}],[{"start":{"row":55,"column":3},"end":{"row":56,"column":0},"action":"insert","lines":["",""],"id":253}],[{"start":{"row":56,"column":0},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":254}],[{"start":{"row":57,"column":0},"end":{"row":68,"column":3},"action":"insert","lines":["// LOGIN ROUTES","//render login form","app.get(\"/login\", function(req, res){","   res.render(\"login\"); ","});","//login logic","//middleware","app.post(\"/login\", passport.authenticate(\"local\", {","    successRedirect: \"/secret\",","    failureRedirect: \"/login\"","}) ,function(req, res){","});"],"id":255}],[{"start":{"row":68,"column":3},"end":{"row":69,"column":0},"action":"insert","lines":["",""],"id":256}],[{"start":{"row":69,"column":0},"end":{"row":70,"column":0},"action":"insert","lines":["",""],"id":257}],[{"start":{"row":70,"column":0},"end":{"row":73,"column":3},"action":"insert","lines":["app.get(\"/logout\", function(req, res){","    req.logout();","    res.redirect(\"/\");","});"],"id":258}],[{"start":{"row":73,"column":3},"end":{"row":74,"column":0},"action":"insert","lines":["",""],"id":259}],[{"start":{"row":74,"column":0},"end":{"row":75,"column":0},"action":"insert","lines":["",""],"id":260}],[{"start":{"row":75,"column":0},"end":{"row":80,"column":1},"action":"insert","lines":["function isLoggedIn(req, res, next){","    if(req.isAuthenticated()){","        return next();","    }","    res.redirect(\"/login\");","}"],"id":261}],[{"start":{"row":80,"column":1},"end":{"row":81,"column":0},"action":"insert","lines":["",""],"id":262}],[{"start":{"row":81,"column":0},"end":{"row":82,"column":0},"action":"insert","lines":["",""],"id":263}],[{"start":{"row":82,"column":0},"end":{"row":84,"column":2},"action":"insert","lines":["app.listen(process.env.PORT, process.env.IP, function(){","    console.log(\"server started.......\");","})"],"id":264}]]},"ace":{"folds":[],"scrolltop":982.3333601951599,"scrollleft":0,"selection":{"start":{"row":10,"column":30},"end":{"row":10,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":76,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1487483878291,"hash":"d5fc9b80e3d5e21b85fbcb654e8ff09dad3a8d4a"}